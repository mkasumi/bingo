<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ビンゴゲーム</title>
  <link rel="stylesheet" href="./css/bingo.min.css">
  <script src="js/vue.js"></script>
</head>
<body>
<div id="app">
  <ol id="priviously-items" class="priviously-items">
    <li v-for="num in nums">{{ num.text }}</li>
  </ol>
  <button v-on:click="nextNum">Next Num</button>

  <div class="section__group">
    <section v-for="(section,index) in sections" class="section" :class="['section--' + section]">
      <h1 class="section-title">{{section}}</h1>
      <div class="numbers__group">
        <ul class="numbers" :class="['index--' + index]">
          <!--<span v-text="index | slice '0' '4'"></span>-->
          <li v-for="item in slicedItems" v-bind:class="{ active: item.selected }">{{item.text}}</li>
        </ul>
      </div>
    </section>
  </div>
</div>
<script>

var items = [];
 for (var i = 1; i < 76; i++){
   items.push({text:i,selected:false});
 }

 //Fisher-Yates Algorithm きちんとシャッフルしてくれるらしい
	//Arrayにshuffleメソッドをprototypeプロパティを使って追加
	Array.prototype.shuffle = function() {
	var i = this.length;
    while (i) {
      var j = Math.floor(Math.random()*i);
      var t = this[--i];
      this[i] = this[j];
      this[j] = t;
    }
	};
	//Fisher-Yates End
	//1~75の番号の配列
	var allNums = [];
	for(i=1;i<76;i++){
		allNums.push(i);
	}

  // Vue.filter('slice', function (value, begin, end) {
  //   return value.slice(begin, end)
  // })



  allNums.shuffle();

  var count=1

  var app = new Vue({
    el: '#app',
    data: {
      items: items,
      nums:[],
      sections: ['B','I','N','G','O']
    },
    computed:{
       slicedItems: function (value){
        //  var times = this.$parent.$index;
        //  console.log(times);
        var times = value;
         var sliceAmount = 15 * times;
         return this.items.slice(0, 15);
      }
    },
    methods: {
      nextNum: function () {
         var selectedNums = allNums.indexOf(count)+1;
         count++;

         if(count>76){
           alert('Game is Done!')
            return false;
        }

        app.nums.push({ text:selectedNums, selected:true});
        app.items[selectedNums-1].selected = true;

        if(count > 7) {
          var previous = document.getElementById('priviously-items');
          var firstChild = previous.firstElementChild;
          previous.removeChild(firstChild); 
        };
      }
    }
  })
</script>
</body>
</html>